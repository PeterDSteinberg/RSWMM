<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Rswmm by PeterDSteinberg</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Rswmm</h1>
        <p>Autocalibration for EPA Stormwater Management Model (SWMM) version 5.  You&#39;re fully responsible for the any problems related to this software - I&#39;m not maintaining it because I am working on a similar, separate and larger programming effort.</p>

        <p class="view"><a href="https://github.com/PeterDSteinberg/RSWMM">View the Project on GitHub <small>PeterDSteinberg/RSWMM</small></a></p>


        <ul>
          <li><a href="https://github.com/PeterDSteinberg/RSWMM/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/PeterDSteinberg/RSWMM/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/PeterDSteinberg/RSWMM">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="rswmm" class="anchor" href="#rswmm" aria-hidden="true"><span class="octicon octicon-link"></span></a>RSWMM</h1>

<h3>
<a id="autocalibration-for-epa-stormwater-management-model-swmm-version-5-using-multi--or-single-objective-optimization-in-r" class="anchor" href="#autocalibration-for-epa-stormwater-management-model-swmm-version-5-using-multi--or-single-objective-optimization-in-r" aria-hidden="true"><span class="octicon octicon-link"></span></a>Autocalibration for EPA Stormwater Management Model (SWMM) version 5 using multi- or single objective optimization in R.
</h3>

<h5>
<a id="youre-fully-responsible-for-the-any-problems-related-to-this-software---im-not-maintaining-it-currently--it-was-tested-with-50022--it-looks-like-if-moving-to-swmm-version-51-the-binary-file-reader-in-rswmmr-would-have-to-be-changed-probably-a-minor-change-see-item-33-under-build-51001-3242014-on-this-epa-page-listing-swmm-changes-by-version" class="anchor" href="#youre-fully-responsible-for-the-any-problems-related-to-this-software---im-not-maintaining-it-currently--it-was-tested-with-50022--it-looks-like-if-moving-to-swmm-version-51-the-binary-file-reader-in-rswmmr-would-have-to-be-changed-probably-a-minor-change-see-item-33-under-build-51001-3242014-on-this-epa-page-listing-swmm-changes-by-version" aria-hidden="true"><span class="octicon octicon-link"></span></a>You're fully responsible for the any problems related to this software - I'm not maintaining it currently.  It was tested with 5.0.022.  It looks like if moving to SWMM version 5.1+, the binary file reader in RSWMM.r would have to be changed (probably a minor change). See item 33 under "Build 5.1.001 (3/24/2014)" on this<a href="http://www2.epa.gov/sites/production/files/2014-10/epaswmm5_updates_0.txt"> EPA page listing SWMM changes by version.</a>
</h5>

<h6>
<a id="synopsis" class="anchor" href="#synopsis" aria-hidden="true"><span class="octicon octicon-link"></span></a>Synopsis:</h6><p>This R code runs a SWMM input text file repeatedly with modification of the text file based on the last SWMM output and the next trial parameters selected by R optimization code.  The prerequisites for using the code are having a SWMM input file, calibration data, willingness to read code (it's not that bad :)), and willingness to check the output closely as the code is experimental.  These scripts currently only do autocalibration.</p>
<h6>
<a id="i-am-working-on-a-similar-separate-and-larger-programming-effort-in-parallelized-python-not-r-rswmm-is-only-a-proof-of-concept-the-new-effort-extends-these-ideas-to-a-more-flexible-interface-and-tiered-design-optimization--if-you-are-interested-in-any-of-that-or-have-any-feedback-on-rswmm-please-let-me-know-see-below-" class="anchor" href="#i-am-working-on-a-similar-separate-and-larger-programming-effort-in-parallelized-python-not-r-rswmm-is-only-a-proof-of-concept-the-new-effort-extends-these-ideas-to-a-more-flexible-interface-and-tiered-design-optimization--if-you-are-interested-in-any-of-that-or-have-any-feedback-on-rswmm-please-let-me-know-see-below-" aria-hidden="true"><span class="octicon octicon-link"></span></a>I am working on a similar, separate and larger programming effort (in parallelized Python not R). RSWMM is only a proof of concept. The new effort extends these ideas to a more flexible interface and tiered design optimization.  If you are interested in any of that, or have any feedback on RSWMM, please let me know (see below) </h6>

<h4>
<a id="summary-of-how-to-use-this-code-efficiently" class="anchor" href="#summary-of-how-to-use-this-code-efficiently" aria-hidden="true"><span class="octicon octicon-link"></span></a>Summary of How to Use this Code Efficiently</h4>

<ol>
<li>Get a SWMM .inp input text file</li>
<li>Read below (a cut and paste of runRSWMM.r) and note each comment's warnings</li>
<li>Choose multi- or single objective</li>
<li>Get your calibration time series CSV in the right format, or use an argument to accomodate your format</li>
<li>Run it after making sure you have disk space or you have edited the code to programmatically delete files</li>
</ol>

<h4>
<a id="runswmmr-is-quoted-below--it-is-just-a-lot-of-help-comments-around-r-function-calls-that-use-swmm-binary-file-reader-as-part-of-autocalibration" class="anchor" href="#runswmmr-is-quoted-below--it-is-just-a-lot-of-help-comments-around-r-function-calls-that-use-swmm-binary-file-reader-as-part-of-autocalibration" aria-hidden="true"><span class="octicon octicon-link"></span></a>runSWMM.r is quoted below.  It is just a lot of help comments around R function calls that use SWMM binary file reader as part of autocalibration.</h4>

<pre><code>
#runRSWMM Developed by Peter Steinberg
#Version 1: December 2011
#Revision 1.1: January 1/10/2012, corrected problem in binary file reader

#General Notes
#Before editing this script do the following things:
#Move your SWMM file to a directory that can hold a lot of files
#Test that you can run your SWMM file from this directory and you haven't messed up paths to files or something
#Take your SWMM input file and replace the uncertain parameters with codes like
#   $1$, $2$,  $3$
#You can repeat codes if you want the optimization algorithm to repeat a parameter.
#For example, if you know 2 subcatchments should have the same infiltration rate, you
# can put the same code in for their infiltration rates and they will receive the same parameter
#Create a parameter bounds CSV file that looks like this (without the comment sign #):
#                 Code,Minimum,Maximum,Initial
#                 $1$,10,32,15
#                 $2$,10,31,20
#                 $3$,4,15,5
#                 $4$,2,8,7
#                 $5$,25,100,33
#                 $6$,20,75,33
#                 $7$,20,60,50

#Create a calibration time series data CSV that looks like this (without the comment sign #):
#Date      ,(CFS)
#1/1/07 0:01,0.08
#1/1/07 0:02,0.22
#1/1/07 0:03,0.38
#1/1/07 0:04,0.54
#1/1/07 0:05,0.67
#1/1/07 0:06,0.83

#REMEMBER YOU HAVE TO USE DOUBLE BACKSLASHES FOR ALL FILENAMES##########
#You have to manually create all directories you provide.  RSWMM does not make directories.

#Preliminaries: clear workspace and source the RSWMM code for a function library
rm(list=ls())
#edit this source line to reflect where you have saved RSWMM.r.
source("O:\\departments\\Water Quality\\Users\\Peter\\programs\\RSWMM\\RSWMM.r")

#If you are doing a calibration run, you need to provide the following lines
# to direct the optimizer to your files
#Calibration Data should be in a CSV with datetimes in the first column,
#and data in the second column
#The text file is assumed to have a one line header
#Call this function with the correct dateFormat for your datetimes
#the dateFormat is passed to strptime, so look for formatting information there
#for example, dates like this 1/1/07 12:00, can be read with the default dateFormat
#e.g.:
#Date      ,(CFS)
#1/1/07 0:01,0.08
#1/1/07 0:02,0.22
#1/1/07 0:03,0.38
#1/1/07 0:04,0.54
#1/1/07 0:05,0.67
#1/1/07 0:06,0.83
#
calDataCSV="O:\\departments\\Water Quality\\Users\\Peter\\programs\\RSWMM\\testingData\\CalData1.csv"

</code></pre>

<p>*Read the rest of <a href="https://github.com/PeterDSteinberg/RSWMM/blob/master/runRSWMM.r">runRSWMM.r</a></p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/PeterDSteinberg">PeterDSteinberg</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-58799823-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>